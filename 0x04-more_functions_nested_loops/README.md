this file contains more functions with nested loops
